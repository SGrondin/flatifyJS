"v1.0.0";(function(){"use strict";var e=function(e,t){var n=this;if(!e){if(typeof console==="object"&&typeof console.log==="function"){console.log("You must pass the 'this' object to the flatify constructor for all features to be available. Ex: new flatify(this);")}e={}}n.level=0;n._runCallbackCalled=false;n.parentInstance=null;n._scope={flatify:{version:"v1.0.0",masterInstance:n,currentInstance:n}};if(e.flatify&&e.flatify.version===n._scope.flatify.version){n._scope=e;n.parentInstance=n._scope.flatify.currentInstance;n._scope.flatify.currentInstance=n;n.level=n.parentInstance.level+1}t=t?t:{};n.defaultOptions={cont:t.cont?t.cont:false,wait:t.wait||t.wait===false?t.wait:true};n.cont=n.defaultOptions.cont;n.wait=n.defaultOptions.wait;n._stepsRan=0;n._steps=[];n._callback=function(){};return n};e.prototype.getIndex=function(){var e=this;return e._stepsRan};e.prototype.getNumberJobs=function(){var e=this;return e._steps.length};e.prototype.deleteJob=function(e){var t=this;t._steps.splice(e,1)};e.prototype.seq=function(e,t,n){var r=this;if(e){t=t?t:{};t={cont:t.cont||t.cont===false?t.cont:r.defaultOptions.cont};var i={job:e,par:false,options:t};if(n||n===0){r._steps.splice(n,0,i)}else{r._steps.push(i)}}return r};e.prototype.par=function(e,t){var n=this;if(e){t=t?t:{};t={cont:t.cont||t.cont===false?t.cont:n.defaultOptions.cont,wait:t.wait||t.wait===false?t.wait:n.defaultOptions.wait,nb:t.nb?t.nb:1};if(!(e instanceof Array)){if(!(t.nb>0)){t.nb=1}var r=[];for(var i=0;i<t.nb;i++){r.push(e)}e=r}n._steps.push({job:e,par:true,options:t})}return n};e.prototype.run=function(e){var t=this;t._callback=e;if(t._steps.length===0){e(null)}else{t._exec(0,null,[])}return t};e.prototype._exec=function(e,t,n){var r=this;if(r._scope.flatify.currentInstance._runCallbackCalled){r._scope.flatify.currentInstance=r._scope.flatify.currentInstance.parentInstance}if(t&&!r.cont||r._stepsRan===r._steps.length){r._execRun(t,n)}else{r.cont=r._steps[e].options.cont;if(r._steps[e].par){r.wait=r._steps[e].options.wait;r._execPar(e,t,n,function(t,n){r._stepsRan++;r._exec(++e,t,n)})}else{r._execSeq(e,t,n,function(t,n){r._stepsRan++;r._exec(++e,t,n)})}}};e.prototype._execRun=function(e,t){var n=this;n._runCallbackCalled=true;t.unshift(e);n._callback.apply(n._scope,t)};e.prototype._execPar=function(e,t,n,r){var i=this;n.unshift(t);var s=n.length;var o=[];var u=[];var a=false;var f=0;var l=false;for(var c=0;c<i._steps[e].job.length;c++){o[c]=[];u[c]=null;n[s]=function(t){return function(n){o[t]=Array.prototype.slice.call(arguments,1);u[t]=n;if(n){a=true}f++;if((f===i._steps[e].job.length||n&&!i.wait)&&!l){l=true;if(!a){u=null}r(u,[o])}}}(c);i._steps[e].job[c].apply(i._scope,n)}};e.prototype._execSeq=function(e,t,n,r){var i=this;n.unshift(t);n.push(function(e){r(e,Array.prototype.slice.call(arguments,1))});i._steps[e].job.apply(i._scope,n)};if(typeof module==="object"&&typeof exports==="object"){exports.flatify=e}else if(typeof window==="object"&&window.window===window&&typeof window.navigator==="object"){window.flatify=e}})()